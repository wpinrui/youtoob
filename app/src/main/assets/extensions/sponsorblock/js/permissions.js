(()=>{"use strict";var e={3531:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.logRequest=t.sendBinaryRequestToCustomServer=t.sendRequestToCustomServer=t.setupBackgroundRequestProxy=t.serializeOrStringify=t.isSerializable=t.sendRealRequestToCustomServer=void 0;const i=o(1108),r=o(1740),s=o(7913),a=o(3262);function c(e,t,o={},r={}){return n(this,void 0,void 0,(function*(){return"get"===e.toLowerCase()&&(t=(0,i.objectToURI)(t,o,!0),o=null),yield fetch(t,{method:e,headers:Object.assign({"Content-Type":"application/json"},r||{}),redirect:"follow",body:o?JSON.stringify(o):null})}))}function l(e){try{return window.structuredClone(e),!0}catch(e){return!1}}function u(e){return l(e)?e:"toString"in e&&"function"==typeof e.toString?e.toString():String(e)}t.sendRealRequestToCustomServer=c,t.isSerializable=l,t.serializeOrStringify=u,t.setupBackgroundRequestProxy=function(){chrome.runtime.onMessage.addListener(((e,t,o)=>"sendRequest"===e.message?(c(e.type,e.url,e.data,e.headers).then((t=>n(this,void 0,void 0,(function*(){const n=e.binary?(0,i.isFirefoxOrSafari)()&&!(0,r.isSafari)()?yield t.blob():Array.from(new Uint8Array(yield t.arrayBuffer())):null;o({responseText:e.binary?"":yield t.text(),responseBinary:n,headers:e.returnHeaders&&t.headers?[...t.headers.entries()].reduce(((e,[t,o])=>(e[t]=o,e)),{}):null,status:t.status,ok:t.ok})})))).catch((e=>{console.error("Proxied request failed:",e),o({error:u(e)})})),!0):"getHash"===e.message&&((0,a.getHash)(e.value,e.times).then(o).catch((e=>{console.error("Hash request failed:",e),o({error:u(e)})})),!0)))},t.sendRequestToCustomServer=function(e,t,o={},n={}){return new Promise(((i,r)=>{chrome.runtime.sendMessage({message:"sendRequest",type:e,url:t,data:o,headers:n},(e=>{"error"in e?r(e.error):i(e)}))}))},t.sendBinaryRequestToCustomServer=function(e,t,o={},n={}){return new Promise(((i,r)=>{chrome.runtime.sendMessage({message:"sendRequest",type:e,url:t,data:o,headers:n,binary:!0,returnHeaders:!0},(e=>{"error"in e?r(e.error):i(e)}))}))},t.logRequest=function(e,t,o){const n="responseText"in e&&!(0,s.isBodyGarbage)(e.responseText)?`: ${e.responseText}`:"";console.warn(`[${t}] Server responded with code ${e.status} to a ${o} request${n}`)}},1740:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.keybindToString=t.formatKey=t.keybindEquals=t.isSafari=t.ProtoConfig=void 0;const i=o(1108);function r(){return"undefined"!=typeof navigator&&"Apple Computer, Inc."===navigator.vendor}function s(e){return null==e?"":" "==e?"Space":1==e.length?e.toUpperCase():e}t.ProtoConfig=class{constructor(e,t,o,n=!1){this.configLocalListeners=[],this.configSyncListeners=[],this.cachedSyncConfig=null,this.cachedLocalStorage=null,this.config=null,this.local=null,this.inDeArrow=!1,this.syncDefaults=e,this.localDefaults=t,this.inDeArrow=n,this.setupConfig(o).then((e=>{this.config=null==e?void 0:e.sync,this.local=null==e?void 0:e.local}))}configProxy(){chrome.storage.onChanged.addListener(((e,t)=>{if("sync"===t){for(const t in e)this.cachedSyncConfig[t]=e[t].newValue;for(const t of this.configSyncListeners)t(e)}else if("local"===t){for(const t in e)this.cachedLocalStorage[t]=e[t].newValue;for(const t of this.configLocalListeners)t(e)}}));let e=0;const t=new Set;let o=null;const n=this,i={set(i,r,s){if(n.cachedSyncConfig[r]=s,Date.now()-e<100){if(t.add(r),!o){const e=()=>{const e=[...t];t.clear(),chrome.storage.sync.set(e.map((e=>[e,n.cachedSyncConfig[e]])).reduce(((e,[t,o])=>(e[t]=o,e)),{})),o=null};o=setTimeout(e,20)}return!0}return chrome.storage.sync.set({[r]:s}),e=Date.now(),!0},get(e,t){const o=n.cachedSyncConfig[t];return e[t]||o},deleteProperty:(e,t)=>(chrome.storage.sync.remove(t),!0)},r={set:(e,t,o)=>(n.cachedLocalStorage[t]=o,chrome.storage.local.set({[t]:o}),!0),get(e,t){const o=n.cachedLocalStorage[t];return e[t]||o},deleteProperty:(e,t)=>(chrome.storage.local.remove(t),!0)};return{sync:new Proxy({handler:i},i),local:new Proxy({handler:r},r)}}forceSyncUpdate(e){const t=this.cachedSyncConfig[e];chrome.storage.sync.set({[e]:t})}forceLocalUpdate(e){const t=this.cachedLocalStorage[e];chrome.storage.local.set({[e]:t},(()=>{const t=chrome.runtime.lastError;t&&"navigationApiAvailable"!==e&&alert(`SponsorBlock/DeArrow: ${chrome.i18n.getMessage("storageFull")}\n\n${t}`)}))}fetchConfig(){return n(this,void 0,void 0,(function*(){yield Promise.all([new Promise((e=>{chrome.storage.sync.get(null,(t=>{this.cachedSyncConfig=t,void 0===this.cachedSyncConfig&&(this.cachedSyncConfig={},(this.inDeArrow||window.location.href.includes("options.html"))&&alert(`${chrome.i18n.getMessage("syncDisabledWarning")}${this.inDeArrow?`\n\n${chrome.i18n.getMessage("syncDisabledWarningDeArrow")}`:""}${(0,i.isFirefoxOrSafari)()&&!r()?`\n\n${chrome.i18n.getMessage("syncDisabledFirefoxSuggestions")}`:""}`)),e()}))})),new Promise((e=>{chrome.storage.local.get(null,(t=>{this.cachedLocalStorage=null!=t?t:{},e()}))}))])}))}setupConfig(e){return n(this,void 0,void 0,(function*(){if("undefined"==typeof chrome)return null;yield this.fetchConfig(),this.addDefaults();const t=this.configProxy();return e(t.sync,t.local),t}))}addDefaults(){for(const e in this.syncDefaults)if(Object.prototype.hasOwnProperty.call(this.cachedSyncConfig,e)){if("barTypes"===e)for(const t in this.syncDefaults[e])Object.prototype.hasOwnProperty.call(this.cachedSyncConfig[e],t)||(this.cachedSyncConfig[e][t]=this.syncDefaults[e][t])}else this.cachedSyncConfig[e]=this.syncDefaults[e];for(const e in this.localDefaults)Object.prototype.hasOwnProperty.call(this.cachedLocalStorage,e)||(this.cachedLocalStorage[e]=this.localDefaults[e])}isReady(){return null!==this.config}},t.isSafari=r,t.keybindEquals=function(e,t){return!(null==e||null==t||Boolean(e.alt)!=Boolean(t.alt)||Boolean(e.ctrl)!=Boolean(t.ctrl)||Boolean(e.shift)!=Boolean(t.shift)||null==e.key&&null==e.code||null==t.key&&null==t.code)&&(null!=e.code&&null!=t.code?e.code===t.code:null!=e.key&&null!=t.key&&e.key.toUpperCase()===t.key.toUpperCase())},t.formatKey=s,t.keybindToString=function(e){if(null==e||null==e.key)return"";let t="";return e.ctrl&&(t+="Ctrl + "),e.alt&&(t+="Alt + "),e.shift&&(t+="Shift + "),t+s(e.key)}},4148:function(e,t){var o=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};function n(e,t=!1){var o,n,i;if(!e)return!1;if("VIDEO"===e.tagName&&(e.classList.contains("html5-main-video")||"player"===e.id||"player_html5_api"===e.id)&&1===[...document.querySelectorAll("video")].filter((e=>e.duration)).length&&e.duration)return!0;if(0===e.offsetHeight||0===e.offsetWidth&&!t)return!1;const r=null==e?void 0:e.getBoundingClientRect(),s=document.elementFromPoint(r.left+r.width/2,r.top+r.height/2)||document.elementFromPoint(r.left,r.top);return!s&&"movie_player"===e.id&&r.top<0||!!(s===e||s&&e.contains(s)||s&&s.contains(e))||"VIDEO"===e.tagName&&(!!(null===(o=null==s?void 0:s.closest(".html5-video-player"))||void 0===o?void 0:o.contains(e))||!!(null===(i=null===(n=null==e?void 0:e.closest("#inline-preview-player"))||void 0===n?void 0:n.classList)||void 0===i?void 0:i.contains("playing-mode")))}function i(e,t=!1,o=!0){var i,r;return n(e,t)||o&&!!e&&(n(e.parentElement,t)||n(null!==(r=null===(i=e.parentElement)||void 0===i?void 0:i.parentElement)&&void 0!==r?r:null,t))}function r(e,t=!1,o=!1){return s(e,t,o)}function s(e,t=!1,o=!1,n){for(const r of e){const e=n?n(r):r;if(e&&i(e,t,o))return e}return null}function a(e,t){for(const o of e){const e=document.querySelector(o);if(e&&t(e))return e}return null}Object.defineProperty(t,"__esModule",{value:!0}),t.getElement=t.waitForElement=t.findNonEmptyElement=t.findPredicatedElement=t.findValidElement=t.findValidElementFromSelector=t.isVisibleOrParent=t.isVisible=void 0,t.isVisible=n,t.isVisibleOrParent=i,t.findValidElementFromSelector=function(e,t=!1,o=!1){return s(e,t,o,(e=>document.querySelector(e)))},t.findValidElement=r,t.findPredicatedElement=a,t.findNonEmptyElement=function(e){return a(e,(e=>{var t,o;return(null!==(o=null===(t=e.textContent)||void 0===t?void 0:t.trim())&&void 0!==o?o:"").length>0}))};let c=!1,l=null,u=[];function d(){if(!l){const e=e=>{var t;const o=[];for(const n of u){const{selector:i,visibleCheck:s,ignoreWidth:a,checkParent:c,callbacks:l}=n;let u=!0;if(e){let t=!1;for(const o of e)if("childList"===o.type&&o.addedNodes.length>0){if(o.target instanceof HTMLElement&&(o.target.matches(i)||o.target.querySelector(i))){t=!0;break}for(const e of o.addedNodes)if(e instanceof HTMLElement&&(e.matches(i)||e.querySelector(i))){t=!0;break}if(t)break}t||(u=!1)}const d=u?document.querySelectorAll(i):n.elements;if(d&&d.length>0){n.elements=d;const e=s?r(d,a,c):d[0];if(e){if(null===(t=chrome.runtime)||void 0===t?void 0:t.id)for(const t of l)t(e);o.push(i)}}}u=u.filter((e=>!o.includes(e.selector))),0===u.length&&(null==l||l.disconnect(),l=null,c=!1)};e(),u.length>0&&(l=new MutationObserver(e),l.observe(document.documentElement,{childList:!0,subtree:!0}))}}function p(e,t,o=!1,n=!1){return t?r(document.querySelectorAll(e),o,n):document.querySelector(e)}t.waitForElement=function(e,t=!1,n=!1,i=!1){return o(this,void 0,void 0,(function*(){return yield new Promise((o=>{const r=p(e,t,n,i);if(r)return void o(r);const s=u.find((o=>o.selector===e&&o.visibleCheck===t));s?s.callbacks.push(o):u.push({selector:e,visibleCheck:t,ignoreWidth:n,checkParent:i,callbacks:[o]}),c||(c=!0,document.body?d():window.addEventListener("DOMContentLoaded",(()=>{d()})))}))}))},t.getElement=p},7913:(e,t)=>{function o(e){return e.startsWith("<!DOCTYPE html>")||e.startsWith("<html>")||e.includes("cf-wrapper")}Object.defineProperty(t,"__esModule",{value:!0}),t.formatJSErrorMessage=t.getLongErrorMessage=t.isBodyGarbage=t.getShortErrorMessage=t.getFormattedTime=t.getFormattedTimeToSeconds=void 0,t.getFormattedTimeToSeconds=function(e){const t=/^(?:(?:(\d+):)?(\d+):)?(\d*(?:[.,]\d+)?)$/.exec(e);return null===t?null:3600*(t[1]?parseInt(t[1]):0)+60*(t[2]?parseInt(t[2]||"0"):0)+(t[3]?parseFloat(t[3].replace(",",".")):0)},t.getFormattedTime=function(e,t){e=Math.max(e,0);const o=Math.floor(e/60/60),n=Math.floor(e/60)%60;let i=String(n),r=e%60;t||(r=Math.floor(r));let s=String(t?r.toFixed(3):r);return r<10&&(s="0"+s),o&&n<10&&(i="0"+i),isNaN(o)||isNaN(n)?null:(o?o+":":"")+i+":"+s},t.getShortErrorMessage=function(e,t){if(0===e)return chrome.i18n.getMessage("0");const o=t&&!t.includes("cf-wrapper")&&!t.includes("<!DOCTYPE html>")&&t.length<64?` ${t}`:"";let n=chrome.i18n.getMessage(`${503===e?502:e}`);return""===n&&(n=chrome.i18n.getMessage("connectionError")),`${n} ${chrome.i18n.getMessage("errorCode").replace("{code}",`${e}${o}`)}`},t.isBodyGarbage=o,t.getLongErrorMessage=function(e,t){if(0===e)return chrome.i18n.getMessage("0");const n=t&&!o(t)?"\n\n"+t:"";let i=chrome.i18n.getMessage(`${503===e?502:e}`);return""===i&&(i=chrome.i18n.getMessage("connectionError")),`${i} ${chrome.i18n.getMessage("errorCode").replace("{code}",`${e}`)}${n}${502===e||503===e?`\n\n${chrome.i18n.getMessage("statusReminder")}`:""}`},t.formatJSErrorMessage=function(e){return`${chrome.i18n.getMessage("connectionError")} ${e}`}},3262:function(e,t){var o=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getHash=void 0,t.getHash=function(e,t=5e3){return o(this,void 0,void 0,(function*(){if(t<=0)return"";if(!("subtle"in crypto))return new Promise(((o,n)=>chrome.runtime.sendMessage({message:"getHash",value:e,times:t},(e=>{e.error?n(e.error):o(e)}))));let o=e;for(let e=0;e<t;e++){const e=yield crypto.subtle.digest("SHA-256",(new TextEncoder).encode(o).buffer);o=Array.from(new Uint8Array(e)).map((e=>e.toString(16).padStart(2,"0"))).join("")}return o}))}},1108:function(e,t){var o,n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.extensionUserAgent=t.isFirefoxOrSafari=t.isFirefox=t.timeoutPomise=t.PromiseTimeoutError=t.objectToURI=t.waitFor=void 0,t.waitFor=function(e,t=5e3,o=100,i){return n(this,void 0,void 0,(function*(){return yield new Promise(((n,r)=>{let s=null;const a=()=>{const t=e();(i?i(t):t)&&(n(t),s&&clearInterval(s))};t&&(setTimeout((()=>{clearInterval(s),r(`TIMEOUT waiting for ${null==e?void 0:e.toString()}: ${Error().stack}`)}),t),s=setInterval(a,o)),a()}))}))},t.objectToURI=function(e,t,o){let n=0;for(const i in t){const r=e.includes("?")||n>0?"&":o?"?":"",s="string"==typeof t[i]?t[i]:JSON.stringify(t[i]);e+=r+encodeURIComponent(i)+"="+encodeURIComponent(s),n++}return e};class i extends Error{constructor(e){super("Promise timed out"),this.promise=e}}t.PromiseTimeoutError=i,t.timeoutPomise=function(e){return new Promise(((t,o)=>{e&&setTimeout((()=>{o(new i)}),e)}))};const r="undefined"!=typeof chrome&&!!chrome.runtime.getManifest().browser_specific_settings,s="undefined"!=typeof chrome&&!!(null===(o=chrome.runtime.getManifest().browser_specific_settings)||void 0===o?void 0:o.gecko);let a;t.isFirefox=function(){return s},t.isFirefoxOrSafari=function(){return r},t.extensionUserAgent=function(){return null!=a||(a=`${chrome.runtime.id}/v${chrome.runtime.getManifest().version}`),a}},3497:(e,t)=>{function o(e){const t=e.replace(/__MSG_(\w+)__/g,(function(e,t){return t?chrome.i18n.getMessage(t).replace(/</g,"&#60;").replace(/"/g,"&quot;").replace(/\n/g,"<br/>"):""}));return t!=e&&t}Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalizedMessage=t.localizeHtmlPage=t.generateUserID=void 0,t.generateUserID=function(e=36){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let o="";const n="undefined"==typeof window?crypto:window.crypto;if(n&&n.getRandomValues){const i=new Uint32Array(e);n.getRandomValues(i);for(let n=0;n<e;n++)o+=t[i[n]%62];return o}for(let n=0;n<e;n++)o+=t[Math.floor(62*Math.random())];return o},t.localizeHtmlPage=function(){const e=o(document.title);e&&(document.title=e);const t=document.querySelector(".sponsorBlockPageBody"),n=o(t.innerHTML.toString());n&&(t.innerHTML=n)},t.getLocalizedMessage=o},8856:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.generateDebugDetails=void 0;const n=o(8272),i=o(5339),r=o(9209),s=o(1740),a=o(9059);class c extends s.ProtoConfig{resetToDefault(){chrome.storage.sync.set(Object.assign(Object.assign({},this.syncDefaults),{userID:this.config.userID,minutesSaved:this.config.minutesSaved,skipCount:this.config.skipCount,sponsorTimesContributed:this.config.sponsorTimesContributed})),chrome.storage.local.set(Object.assign({},this.localDefaults))}}const l=new c({userID:null,isVip:!1,permissions:{},defaultCategory:"chooseACategory",segmentListDefaultTab:r.SegmentListDefaultTab.Segments,renderSegmentsAsChapters:!1,forceChannelCheck:!1,minutesSaved:0,skipCount:0,sponsorTimesContributed:0,submissionCountSinceCategories:0,showTimeWithSkips:!0,disableSkipping:!1,muteSegments:!0,fullVideoSegments:!0,fullVideoLabelsOnThumbnails:!0,manualSkipOnFullVideo:!1,trackViewCount:!0,trackViewCountInPrivate:!0,trackDownvotes:!0,trackDownvotesInPrivate:!1,dontShowNotice:!1,showUpcomingNotice:!1,noticeVisibilityMode:r.NoticeVisibilityMode.FadedForAutoSkip,hideVideoPlayerControls:!1,hideInfoButtonPlayerControls:!1,hideDeleteButtonPlayerControls:!1,hideUploadButtonPlayerControls:!1,hideSkipButtonPlayerControls:!1,hideDiscordLaunches:0,hideDiscordLink:!1,invidiousInstances:[],supportInvidious:!1,serverAddress:n.serverAddress,minDuration:0,skipNoticeDuration:4,audioNotificationOnSkip:!1,checkForUnlistedVideos:!1,testingServer:!1,ytInfoPermissionGranted:!1,allowExpirements:!0,showDonationLink:!0,showPopupDonationCount:0,showUpsells:!0,showNewFeaturePopups:!0,donateClicked:0,autoHideInfoButton:!0,autoSkipOnMusicVideos:!1,skipNonMusicOnlyOnYoutubeMusic:!1,scrollToEditTimeUpdate:!1,categoryPillUpdate:!1,hookUpdate:!1,showChapterInfoMessage:!0,darkMode:!0,showCategoryGuidelines:!0,showCategoryWithoutPermission:!1,showSegmentNameInChapterBar:!0,showAutogeneratedChapters:!0,useVirtualTime:!0,showSegmentFailedToFetchWarning:!0,allowScrollingToEdit:!0,deArrowInstalled:!1,showDeArrowPromotion:!0,showDeArrowInSettings:!0,shownDeArrowPromotion:!1,showZoomToFillError2:!0,cleanPopup:!1,hideSegmentCreationInPopup:!1,prideTheme:!1,categoryPillColors:{},skipKeybind:{key:"Enter"},skipToHighlightKeybind:{key:"Enter",ctrl:!0},startSponsorKeybind:{key:";"},submitKeybind:{key:"'"},actuallySubmitKeybind:{key:"'",ctrl:!0},previewKeybind:{key:";",ctrl:!0},nextChapterKeybind:{key:"ArrowRight",ctrl:!0},previousChapterKeybind:{key:"ArrowLeft",ctrl:!0},closeSkipNoticeKeybind:{key:"Backspace"},downvoteKeybind:{key:"h",shift:!0},upvoteKeybind:{key:"g",shift:!0},categorySelections:[{name:"sponsor",option:r.CategorySkipOption.AutoSkip},{name:"poi_highlight",option:r.CategorySkipOption.ManualSkip},{name:"exclusive_access",option:r.CategorySkipOption.ShowOverlay},{name:"chapter",option:r.CategorySkipOption.ShowOverlay}],payments:{licenseKey:null,lastCheck:0,lastFreeCheck:0,freeAccess:!1,chaptersAllowed:!1},colorPalette:{red:"#780303",white:"#ffffff",locked:"#ffc83d"},barTypes:{"preview-chooseACategory":{color:"#ffffff",opacity:"0.7"},sponsor:{color:"#00d400",opacity:"0.7"},"preview-sponsor":{color:"#007800",opacity:"0.7"},selfpromo:{color:"#ffff00",opacity:"0.7"},"preview-selfpromo":{color:"#bfbf35",opacity:"0.7"},exclusive_access:{color:"#008a5c",opacity:"0.7"},interaction:{color:"#cc00ff",opacity:"0.7"},"preview-interaction":{color:"#6c0087",opacity:"0.7"},intro:{color:"#00ffff",opacity:"0.7"},"preview-intro":{color:"#008080",opacity:"0.7"},outro:{color:"#0202ed",opacity:"0.7"},"preview-outro":{color:"#000070",opacity:"0.7"},preview:{color:"#008fd6",opacity:"0.7"},"preview-preview":{color:"#005799",opacity:"0.7"},hook:{color:"#395699",opacity:"0.8"},"preview-hook":{color:"#273963",opacity:"0.7"},music_offtopic:{color:"#ff9900",opacity:"0.7"},"preview-music_offtopic":{color:"#a6634a",opacity:"0.7"},poi_highlight:{color:"#ff1684",opacity:"0.7"},"preview-poi_highlight":{color:"#9b044c",opacity:"0.7"},filler:{color:"#7300FF",opacity:"0.9"},"preview-filler":{color:"#2E0066",opacity:"0.7"},chapter:{color:"#ffd983",opacity:"0"}}},{downvotedSegments:{},navigationApiAvailable:null,alreadyInstalled:!1,unsubmittedSegments:{},skipRules:[],channelSkipProfileIDs:{},skipProfiles:{},skipProfileTemp:null},(function(e,t){if(t.skipRules&&0!==t.skipRules.length&&t.skipRules[0].rules){const e=[];for(const o of t.skipRules){const t=o.rules;if(0!==t.length){let n=Object.assign({kind:"check"},t[0]);for(let e=1;e<t.length;e++)n={kind:"operator",operator:a.PredicateOperator.And,left:n,right:Object.assign({kind:"check"},t[e])};const i=o.comment;e.push({predicate:n,skipOption:o.skipOption,comments:0===i.length?[]:i.split(/;\s*/)})}}t.skipRules=e}if(e.whitelistedChannels){const o=e.whitelistedChannels,n="default-whitelist";t.skipProfiles[n]={name:chrome.i18n.getMessage("WhitelistedChannels"),categorySelections:e.categorySelections.filter((e=>!["exclusive_access","chapter"].includes(e.name))).map((e=>({name:e.name,option:r.CategorySkipOption.ShowOverlay}))),showAutogeneratedChapters:null,autoSkipOnMusicVideos:null,skipNonMusicOnlyOnYoutubeMusic:null,muteSegments:null,fullVideoSegments:null,manualSkipOnFullVideo:null,minDuration:null},t.skipProfiles=t.skipProfiles;for(const e of o)t.channelSkipProfileIDs[e]=n;t.channelSkipProfileIDs=t.channelSkipProfileIDs,chrome.storage.sync.remove("whitelistedChannels")}if(e.changeChapterColor||(e.barTypes.chapter.color="#ffd983",e.changeChapterColor=!0,chrome.storage.sync.set({changeChapterColor:!0,barTypes:e.barTypes})),e.showZoomToFillError&&chrome.storage.sync.remove("showZoomToFillError"),e.unsubmittedSegments&&Object.keys(e.unsubmittedSegments).length>0&&chrome.storage.local.set({unsubmittedSegments:e.unsubmittedSegments},(()=>{chrome.storage.sync.remove("unsubmittedSegments")})),e.chapterCategoryAdded||(e.chapterCategoryAdded=!0,e.categorySelections.some((e=>"chapter"===e.name))||(e.categorySelections.push({name:"chapter",option:r.CategorySkipOption.ShowOverlay}),e.categorySelections=e.categorySelections)),void 0!==e.exclusive_accessCategoryAdded&&chrome.storage.sync.remove("exclusive_accessCategoryAdded"),void 0!==e.fillerUpdate&&chrome.storage.sync.remove("fillerUpdate"),void 0!==e.highlightCategoryAdded&&chrome.storage.sync.remove("highlightCategoryAdded"),void 0!==e.highlightCategoryUpdate&&chrome.storage.sync.remove("highlightCategoryUpdate"),e.askAboutUnlistedVideos&&chrome.storage.sync.remove("askAboutUnlistedVideos"),!e.autoSkipOnMusicVideosUpdate){e.autoSkipOnMusicVideosUpdate=!0;for(const t of e.categorySelections)if("music_offtopic"===t.name&&t.option===r.CategorySkipOption.AutoSkip){e.autoSkipOnMusicVideos=!0;break}}if(e.disableAutoSkip)for(const t of e.categorySelections)"sponsor"===t.name&&(t.option=r.CategorySkipOption.ManualSkip,chrome.storage.sync.remove("disableAutoSkip"));"string"==typeof e.skipKeybind&&(e.skipKeybind={key:e.skipKeybind}),"string"==typeof e.startSponsorKeybind&&(e.startSponsorKeybind={key:e.startSponsorKeybind}),"string"==typeof e.submitKeybind&&(e.submitKeybind={key:e.submitKeybind});const o=["skipKeybind","startSponsorKeybind","submitKeybind"];for(let t=o.length-1;t>=0;t--)for(let n=0;n<o.length;n++)t!=n&&(0,s.keybindEquals)(e[o[t]],e[o[n]])&&(e[o[t]]=null);void 0!==e.sponsorVideoID&&chrome.storage.sync.remove("sponsorVideoID"),void 0!==e.previousVideoID&&chrome.storage.sync.remove("previousVideoID"),!e.supportInvidious&&e.invidiousInstances.length<i.length&&(e.invidiousInstances=[...new Set([...i,...e.invidiousInstances])]),e.lastIsVipUpdate&&chrome.storage.sync.remove("lastIsVipUpdate")}));t.default=l,t.generateDebugDetails=function(){const e={debug:{userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,extensionVersion:chrome.runtime.getManifest().version},config:JSON.parse(JSON.stringify(l.cachedSyncConfig))};return delete e.config.userID,e.config.serverAddress=e.config.serverAddress===n.serverAddress?"Default server address":"Custom server address",e.config.invidiousInstances=e.config.invidiousInstances.length,e.config.skipRules=e.config.skipRules.length,JSON.stringify(e,null,4)}},5004:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=o(8856),r=o(205),s=o(3497),a=new r.default;function c(){return n(this,void 0,void 0,(function*(){(0,s.localizeHtmlPage)(),document.getElementById("acceptPermissionButton").addEventListener("click",(()=>{a.applyInvidiousPermissions(i.default.config.supportInvidious).then((e=>{i.default.config.supportInvidious=e,e?(alert(chrome.i18n.getMessage("permissionRequestSuccess")),window.close()):alert(chrome.i18n.getMessage("permissionRequestFailed"))}))}))}))}i.default.config,"complete"===document.readyState?c():document.addEventListener("DOMContentLoaded",c)},9209:(e,t)=>{var o,n,i,r,s,a,c;Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentListDefaultTab=t.NoticeVisibilityMode=t.ChannelIDStatus=t.SponsorSourceType=t.ActionTypes=t.ActionType=t.SponsorHideType=t.CategorySkipOption=void 0,(c=t.CategorySkipOption||(t.CategorySkipOption={}))[c.FallbackToDefault=-2]="FallbackToDefault",c[c.Disabled=-1]="Disabled",c[c.ShowOverlay=0]="ShowOverlay",c[c.ManualSkip=1]="ManualSkip",c[c.AutoSkip=2]="AutoSkip",(a=t.SponsorHideType||(t.SponsorHideType={}))[a.Visible=void 0]="Visible",a[a.Downvoted=1]="Downvoted",a[a.MinimumDuration=2]="MinimumDuration",a[a.Hidden=3]="Hidden",function(e){e.Skip="skip",e.Mute="mute",e.Chapter="chapter",e.Full="full",e.Poi="poi"}(o=t.ActionType||(t.ActionType={})),t.ActionTypes=[o.Skip,o.Mute,o.Chapter,o.Full,o.Poi],(s=t.SponsorSourceType||(t.SponsorSourceType={}))[s.Server=void 0]="Server",s[s.Local=1]="Local",s[s.YouTube=2]="YouTube",s[s.Autogenerated=3]="Autogenerated",(r=t.ChannelIDStatus||(t.ChannelIDStatus={}))[r.Fetching=0]="Fetching",r[r.Found=1]="Found",r[r.Failed=2]="Failed",(i=t.NoticeVisibilityMode||(t.NoticeVisibilityMode={}))[i.FullSize=0]="FullSize",i[i.MiniForAutoSkip=1]="MiniForAutoSkip",i[i.MiniForAll=2]="MiniForAll",i[i.FadedForAutoSkip=3]="FadedForAutoSkip",i[i.FadedForAll=4]="FadedForAll",(n=t.SegmentListDefaultTab||(t.SegmentListDefaultTab={}))[n.Segments=0]="Segments",n[n.Chapters=1]="Chapters"},205:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=o(8856),r=o(9209),s=o(3262),a=o(1108),c=o(4148),l=o(1740),u=o(6062),d=o(3531),p=o(7913);t.default=class{constructor(e=null){this.js=["./js/content.js"],this.css=["content.css","./libs/Source+Sans+Pro.css","popup.css","shared.css"],this.backgroundScriptContainer=e}wait(e,t=5e3,o=100){return n(this,void 0,void 0,(function*(){return(0,a.waitFor)(e,t,o)}))}containsPermission(e){return new Promise((t=>{chrome.permissions.contains(e,t)}))}setupExtraSitePermissions(e){const t=[];(0,l.isSafari)()&&t.push("webNavigation"),chrome.permissions.request({origins:this.getPermissionRegex(),permissions:t},(t=>n(this,void 0,void 0,(function*(){t?this.setupExtraSiteContentScripts():this.removeExtraSiteRegistration(),e(t)}))))}getExtraSiteRegistration(){return{message:"registerContentScript",id:"invidious",allFrames:!0,js:this.js,css:this.css,matches:this.getPermissionRegex()}}setupExtraSiteContentScripts(){const e=this.getExtraSiteRegistration();this.backgroundScriptContainer?this.backgroundScriptContainer.registerFirefoxContentScript(e):chrome.runtime.sendMessage(e)}removeExtraSiteRegistration(){const e="invidious";this.backgroundScriptContainer?this.backgroundScriptContainer.unregisterFirefoxContentScript(e):chrome.runtime.sendMessage({message:"unregisterContentScript",id:e}),chrome.permissions.remove({origins:this.getPermissionRegex()})}applyInvidiousPermissions(e,t="supportInvidious"){return new Promise((o=>{e?this.setupExtraSitePermissions((e=>{e||(i.default.config[t]=!1),o(e)})):(this.removeExtraSiteRegistration(),o(!1))}))}containsInvidiousPermission(){return new Promise((e=>{const t=[];(0,l.isSafari)()&&t.push("webNavigation"),chrome.permissions.contains({origins:this.getPermissionRegex(),permissions:t},(function(t){e(t)}))}))}getMergedTimestamps(e){let t=[];return e.forEach((e=>{const o=t.findIndex((t=>e[0]>=t[0]&&e[0]<=t[1])),n=t.findIndex((t=>e[1]>=t[0]&&e[1]<=t[1]));if(~o&&~n){if(o===n)return;const e=t.splice(Math.max(o,n),1)[0],i=t.splice(Math.min(o,n),1)[0];t.push([Math.min(e[0],i[0]),Math.max(e[1],i[1])])}else~o?t[o][1]=e[1]:~n?t[n][0]=e[0]:t.push(e.slice());t=t.filter((t=>!(t[0]>e[0]&&t[1]<e[1])))})),t}getTimestampsDuration(e){return this.getMergedTimestamps(e).reduce(((e,t)=>e+t[1]-t[0]),0)}getSponsorIndexFromUUID(e,t){for(let o=0;o<e.length;o++)if(e[o].UUID&&(e[o].UUID.startsWith(t)||t.startsWith(e[o].UUID)))return o;return-1}getSponsorTimeFromUUID(e,t){return e[this.getSponsorIndexFromUUID(e,t)]}getPermissionRegex(e=[]){const t=[];0===e.length&&(e=[...i.default.config.invidiousInstances]);for(const o of e)t.push("https://*."+o+"/*"),t.push("http://*."+o+"/*");return t}findReferenceNode(){var e,t;let o=(0,c.findValidElementFromSelector)(["#player-container-id","#movie_player",".html5-video-player","#c4-player","#player-container","#main-panel.ytmusic-player-page","#player-container .video-js",".main-video-section > .video-container",".shaka-video-container","#player-container.ytk-player","#id-tv-container"]);if(null==o){const n=document.getElementById("player");if(o=null==n?void 0:n.firstChild,o){let i=1;for(;i<n.children.length&&(!(null===(e=o.classList)||void 0===e?void 0:e.contains("html5-video-player"))||!(null===(t=o.classList)||void 0===t?void 0:t.contains("ytp-embed")));)o=n.children[i],i++}}return o}isContentScript(){return"http:"===window.location.protocol||"https:"===window.location.protocol}isHex(e){return Boolean(e.match(/^[0-9a-f]+$/i))}addHiddenSegment(e,t,o){return n(this,void 0,void 0,(function*(){if(chrome.extension.inIncognitoContext&&!i.default.config.trackDownvotesInPrivate||!i.default.config.trackDownvotes)return;if(t.length<60){let o;try{o=yield(0,u.asyncRequestToServer)("GET","/api/segmentID",{UUID:t,videoID:e})}catch(e){return console.error("[SB] Caught error while trying to resolve the segment UUID to be hidden",e),void alert(`${chrome.i18n.getMessage("segmentHideFailed")}\n${(0,p.formatJSErrorMessage)(e)}`)}if(!o.ok||!o.responseText)return(0,d.logRequest)(o,"SB","segment UUID resolution"),void alert(`${chrome.i18n.getMessage("segmentHideFailed")}\n${(0,p.getLongErrorMessage)(o.status,o.responseText)}`);t=o.responseText}const n=(yield(0,s.getHash)(e,1)).slice(0,4),a=yield(0,s.getHash)(t,1),c=i.default.local.downvotedSegments,l=c[n]||{segments:[],lastAccess:0};l.lastAccess=Date.now();const h=l.segments.find((e=>e.uuid===a));o===r.SponsorHideType.Visible?(l.segments.splice(l.segments.indexOf(h),1),0===l.segments.length&&delete c[n]):(h?h.hidden=o:l.segments.push({uuid:a,hidden:o}),c[n]=l);const f=Object.entries(c);if(f.length>1e4){let e=null;for(let t=0;t<f[0].length;t++)(null===e||f[t][1].lastAccess<e[1].lastAccess)&&(e=f[t]);delete c[e[0]]}i.default.forceLocalUpdate("downvotedSegments")}))}}},6062:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(i,r){function s(e){try{c(n.next(e))}catch(e){r(e)}}function a(e){try{c(n.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.asyncRequestToServer=void 0;const i=o(8856),r=o(8272),s=o(3531);t.asyncRequestToServer=function(e,t,o={},a={}){return n(this,void 0,void 0,(function*(){const n=i.default.config.testingServer?r.testingServerAddress:i.default.config.serverAddress;return yield(0,s.sendRequestToCustomServer)(e,n+t,o,a)}))}},9059:(e,t)=>{var o,n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.PredicateOperator=t.SkipRuleOperator=t.SkipRuleAttribute=void 0,(i=t.SkipRuleAttribute||(t.SkipRuleAttribute={})).StartTimePercent="time.startPercent",i.StartTime="time.start",i.EndTimePercent="time.endPercent",i.EndTime="time.end",i.DurationPercent="time.durationPercent",i.Duration="time.duration",i.Category="category",i.ActionType="actionType",i.Description="chapter.name",i.Source="chapter.source",i.ChannelID="channel.id",i.ChannelName="channel.name",i.VideoDuration="video.duration",i.Title="video.title",(n=t.SkipRuleOperator||(t.SkipRuleOperator={})).LessOrEqual="<=",n.Less="<",n.GreaterOrEqual=">=",n.Greater=">",n.NotEqual="!=",n.Equal="==",n.NotContains="!*=",n.Contains="*=",n.NotRegex="!~=",n.Regex="~=",n.NotRegexIgnoreCase="!~i=",n.RegexIgnoreCase="~i=",(o=t.PredicateOperator||(t.PredicateOperator={})).And="and",o.Or="or"},5339:e=>{e.exports=JSON.parse('["www.youtubekids.com","inv.nadeko.net","inv.tux.pizza","invidious.adminforge.de","invidious.jing.rocks","invidious.nerdvpn.de","invidious.perennialte.ch","invidious.privacyredirect.com","invidious.reallyaweso.me","invidious.yourdevice.ch","iv.ggtyler.dev","iv.nboeck.de","yewtu.be"]')},8272:e=>{e.exports=JSON.parse('{"serverAddress":"https://sponsor.ajay.app","testingServerAddress":"https://sponsor.ajay.app/test","serverAddressComment":"This specifies the default SponsorBlock server to connect to","categoryList":["sponsor","selfpromo","exclusive_access","interaction","poi_highlight","intro","outro","preview","hook","filler","chapter","music_offtopic"],"categorySupport":{"sponsor":["skip","mute","full"],"selfpromo":["skip","mute","full"],"exclusive_access":["full"],"interaction":["skip","mute"],"intro":["skip","mute"],"outro":["skip","mute"],"preview":["skip","mute"],"hook":["skip","mute"],"filler":["skip","mute"],"music_offtopic":["skip"],"poi_highlight":["poi"],"chapter":["chapter"]},"wikiLinks":{"sponsor":"https://wiki.sponsor.ajay.app/w/Sponsor","selfpromo":"https://wiki.sponsor.ajay.app/w/Unpaid/Self_Promotion","exclusive_access":"https://wiki.sponsor.ajay.app/w/Exclusive_Access","interaction":"https://wiki.sponsor.ajay.app/w/Interaction_Reminder_(Subscribe)","intro":"https://wiki.sponsor.ajay.app/w/Intermission/Intro_Animation","outro":"https://wiki.sponsor.ajay.app/w/Endcards/Credits","preview":"https://wiki.sponsor.ajay.app/w/Preview/Recap","hook":"https://wiki.sponsor.ajay.app/w/Hook/Greetings","filler":"https://wiki.sponsor.ajay.app/w/Tangents/Jokes","music_offtopic":"https://wiki.sponsor.ajay.app/w/Music:_Non-Music_Section","poi_highlight":"https://wiki.sponsor.ajay.app/w/Highlight","guidelines":"https://wiki.sponsor.ajay.app/w/Guidelines","mute":"https://wiki.sponsor.ajay.app/w/Mute_Segment","chapter":"https://wiki.sponsor.ajay.app/w/Chapter"},"extensionImportList":{"chromium":["enamippconapkdmgfgjchkhakpfinmaj"],"firefox":["deArrow@ajay.app","deArrowBETA@ajay.app"],"safari":["app.ajay.dearrow.extension"]}}')}},t={};!function o(n){var i=t[n];if(void 0!==i)return i.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,o),r.exports}(5004)})();
//# sourceMappingURL=https://ajay.app/SponsorBlock/firefox/6.1.2/permissions.js.map